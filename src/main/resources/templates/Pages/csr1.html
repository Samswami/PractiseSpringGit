<html>
<head>
<title>
CSR
</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">

<!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js" crossorigin="anonymous"></script> -->

<link href="css/csr.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

<!-- <script src="js/jquery.easydropdown.js" type="text/javascript"></script> -->
<!--  -->

</head>
<body>
 


<div class="row">
<div class="col-lg-4" style="margin: 0px; padding: 0px">
<div id="mySidenav" class="sidenav">
  <!-- <a href="/keySpecs" id="keyz" target="blank">KeySize</a> -->
  <a href="https://cryptoreport.websecurity.symantec.com/checker/views/csrCheck.jsp" target="blank" id="decoder">Decoder </a>
</div>
<form>
<table align="center">
<tbody >
<br>
<br>
<br>
  <tr>
    <td>
      <strong>
       Key Algorithm : 
      </strong>
    </td>
    <td>
      <select class="form-control" id="keyAlgo" name="KeyAlgorithm" style="width:225px;">
        <option value="RSA" selected='selected'>RSA</option>
        <option value="DSA">DSA</option>
        <option value="ECC">ECC</option>
      </select>
    </td>
  </tr>
  <tr>
    <td>
      <strong>
        Signature Algorithm : 
      </strong>
    </td>
    <td>
       <select class="form-control" id="sigAlgo" name="SignatureAlgorithm" style="width:225px;">
       </select>
    </td>
    <!-- For Select drop down -->
     <!-- For Select drop down -->
      
  </tr>

  <tr>
    <td>
      <strong>
        Key Size :
      </strong>
    </td>
    <td>
      <!-- <input class="form-control" type="text" id="keySize" style="width:225px;" placeholder="2048"  required="required"/> -->
      <select class="form-control" id="keySize" name="keySize" style="width:225px;"></select>
   </td>
   <script type="text/javascript">
          (function() {
                    var bOptions = {
                      "RSA": ["SHA256", "SHA1", "SHA512", "MD5"],
                      "DSA": ["SHA256", "SHA1"],
                      "ECC": ["SHA256", "SHA1", "SHA384", "SHA512"]
                    };

                    var keySelectionDd = {
                      "RSA" : ["2048","512","768","1024","4096"],
                      "DSA" : ["2048"],
                      "ECC" : ["P-256","P-384","P-512","",""]
                    };

                    var keyAlgoVar = document.getElementById('keyAlgo');
                    var sigAlgoVar = document.getElementById('sigAlgo');
                    var keySizeVar = document.getElementById('keySize');

                    //on change is a good event for this because you are guarenteed the value is different
                    keyAlgoVar.onchange = function() {
                      //clear out B
                      sigAlgoVar.length = 0;
                      keySizeVar.length = 0;
                      //get the selected value from A
                      var _val = this.options[this.selectedIndex].value;
                      //loop through bOption at the selected value
                      for (var i in bOptions[_val]) {
                        //create option tag
                        var op = document.createElement('option');
                        //set its value
                        op.value = bOptions[_val][i];
                        //set the display label
                        op.text = bOptions[_val][i];
                        //append it to B
                        sigAlgoVar.appendChild(op);
                      }
                      for (var j in keySelectionDd[_val]) {
                        //create option tag
                        var op1 = document.createElement('option');
                        //set its value
                        op1.value = keySelectionDd[_val][j];
                        //set the display label
                        op1.text = keySelectionDd[_val][j];
                        //append it to B
                        keySizeVar.appendChild(op1);
                      }
                    };
                    //fire this to update B on load
                    keyAlgoVar.onchange();

                  })();
      </script>
  </tr>

  <tr>
    <td>
      <strong><span id="required">*</span>
        Common Name : 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="cn" style="width:225px;" value="abc.bbtest.net"/>
    </td>
  </tr>


  <tr>
    <td>
      <strong><span id="required">*</span>
        Organization : 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="org" style="width:225px;" value="Symantec Corp"/>
    </td>
  </tr>

  <tr>
    <td>
      <strong>
        Organizational Unit : 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="orgUnit" style="width:225px;" value="OrgUnit"/>
    </td>
  </tr>

  <tr>
    <td>
      <strong>
        Country : 
      </strong>
    </td>
    <td>
      <!-- <input class="form-control" maxlength="2"  type="text" id="country" style="width:225px;" placeholder="IN" required="required"/> -->
     <select class="form-control" id="country" name="countrys" style="width:225px;">
      <option value="AF"> Afghanistan </option>
<option value="AX"> Aland Islands </option>
<option value="AL"> Albania </option>
<option value="DZ"> Algeria </option>
<option value="AS"> American Samoa </option>
<option value="AD"> Andorra </option>
<option value="AO"> Angola </option>
<option value="AI"> Anguilla </option>
<option value="AQ"> Antarctica </option>
<option value="AG"> Antigua and Barbuda </option>
<option value="AR"> Argentina </option>
<option value="AM"> Armenia </option>
<option value="AW"> Aruba </option>
<option value="AC"> Ascension Island </option>
<option value="AU"> Australia </option>
<option value="AT"> Austria </option>
<option value="AZ"> Azerbaijan </option>
<option value="BS"> Bahamas </option>
<option value="BH"> Bahrain </option>
<option value="BB"> Barbados </option>
<option value="BD"> Bangladesh </option>
<option value="BY"> Belarus </option>
<option value="BE"> Belgium </option>
<option value="BZ"> Belize </option>
<option value="BJ"> Benin </option>
<option value="BM"> Bermuda </option>
<option value="BT"> Bhutan </option>
<option value="BW"> Botswana </option>
<option value="BO"> Bolivia </option>
<option value="BA"> Bosnia and Herzegovina </option>
<option value="BV"> Bouvet Island </option>
<option value="BR"> Brazil </option>
<option value="IO"> British Indian Ocean Territory </option>
<option value="BN"> Brunei Darussalam </option>
<option value="BG"> Bulgaria </option>
<option value="BF"> Burkina Faso </option>
<option value="BI"> Burundi </option>
<option value="KH"> Cambodia </option>
<option value="CM"> Cameroon </option>
<option value="CA"> Canada </option>
<option value="CV"> Cape Verde </option>
<option value="KY"> Cayman Islands </option>
<option value="CF"> Central African Republic </option>
<option value="TD"> Chad </option>
<option value="CL"> Chile </option>
<option value="CN"> China </option>
<option value="CX"> Christmas Island </option>
<option value="CC"> Cocos (Keeling) Islands </option>
<option value="CO"> Colombia </option>
<option value="KM"> Comoros </option>
<option value="CG"> Congo </option>
<option value="CD"> Congo, Democratic Republic </option>
<option value="CK"> Cook Islands </option>
<option value="CR"> Costa Rica </option>
<option value="CI"> Cote D'Ivoire (Ivory Coast) </option>
<option value="HR"> Croatia (Hrvatska) </option>
<option value="CU"> Cuba </option>
<option value="CY"> Cyprus </option>
<option value="CZ"> Czech Republic </option>
<option value="CS"> Czechoslovakia (former) </option>
<option value="DK"> Denmark </option>
<option value="DJ"> Djibouti </option>
<option value="DM"> Dominica </option>
<option value="DO"> Dominican Republic </option>
<option value="TP"> East Timor </option>
<option value="EC"> Ecuador </option>
<option value="EG"> Egypt </option>
<option value="SV"> El Salvador </option>
<option value="GQ"> Equatorial Guinea </option>
<option value="ER"> Eritrea </option>
<option value="EE"> Estonia </option>
<option value="ET"> Ethiopia </option>
<option value="FK"> Falkland Islands (Malvinas) </option>
<option value="FO"> Faroe Islands </option>
<option value="FJ"> Fiji </option>
<option value="FI"> Finland </option>
<option value="FR"> France </option>
<option value="FX"> France, Metropolitan </option>
<option value="GF"> French Guiana </option>
<option value="PF"> French Polynesia </option>
<option value="TF"> French Southern Territories </option>
<option value="MK"> F.Y.R.O.M. (Macedonia) </option>
<option value="GA"> Gabon </option>
<option value="GM"> Gambia </option>
<option value="GE"> Georgia </option>
<option value="DE"> Germany </option>
<option value="GH"> Ghana </option>
<option value="GI"> Gibraltar </option>
<option value="GB"> Great Britain (UK) </option>
<option value="GR"> Greece </option>
<option value="GL"> Greenland </option>
<option value="GD"> Grenada </option>
<option value="GP"> Guadeloupe </option>
<option value="GU"> Guam </option>
<option value="GT"> Guatemala </option>
<option value="GG"> Guernsey </option>
<option value="GN"> Guinea </option>
<option value="GW"> Guinea-Bissau </option>
<option value="GY"> Guyana </option>
<option value="HT"> Haiti </option>
<option value="HM"> Heard and McDonald Islands </option>
<option value="HN"> Honduras </option>
<option value="HK"> Hong Kong </option>
<option value="HU"> Hungary </option>
<option value="IS"> Iceland </option>
<option selected="" value="IN"> India </option>
<option value="ID"> Indonesia </option>
<option value="IR"> Iran </option>
<option value="IQ"> Iraq </option>
<option value="IE"> Ireland </option>
<option value="IL"> Israel </option>
<option value="IM"> Isle of Man </option>
<option value="IT"> Italy </option>
<option value="JE"> Jersey </option>
<option value="JM"> Jamaica </option>
<option value="JP"> Japan </option>
<option value="JO"> Jordan </option>
<option value="KZ"> Kazakhstan </option>
<option value="KE"> Kenya </option>
<option value="KI"> Kiribati </option>
<option value="KP"> Korea (North) </option>
<option value="KR"> Korea (South) </option>
<option value="KW"> Kuwait </option>
<option value="KG"> Kyrgyzstan </option>
<option value="LA"> Laos </option>
<option value="LV"> Latvia </option>
<option value="LB"> Lebanon </option>
<option value="LI"> Liechtenstein </option>
<option value="LR"> Liberia </option>
<option value="LY"> Libya </option>
<option value="LS"> Lesotho </option>
<option value="LT"> Lithuania </option>
<option value="LU"> Luxembourg </option>
<option value="MO"> Macau </option>
<option value="MG"> Madagascar </option>
<option value="MW"> Malawi </option>
<option value="MY"> Malaysia </option>
<option value="MV"> Maldives </option>
<option value="ML"> Mali </option>
<option value="MT"> Malta </option>
<option value="MH"> Marshall Islands </option>
<option value="MQ"> Martinique </option>
<option value="MR"> Mauritania </option>
<option value="MU"> Mauritius </option>
<option value="YT"> Mayotte </option>
<option value="MX"> Mexico </option>
<option value="FM"> Micronesia </option>
<option value="MD"> Moldova </option>
<option value="MC"> Monaco </option>
<option value="ME"> Montenegro </option>
<option value="MS"> Montserrat </option>
<option value="MA"> Morocco </option>
<option value="MZ"> Mozambique </option>
<option value="MM"> Myanmar </option>
<option value="NA"> Namibia </option>
<option value="NR"> Nauru </option>
<option value="NP"> Nepal </option>
<option value="NL"> Netherlands </option>
<option value="AN"> Netherlands Antilles </option>
<option value="NT"> Neutral Zone </option>
<option value="NC"> New Caledonia </option>
<option value="NZ"> New Zealand (Aotearoa) </option>
<option value="NI"> Nicaragua </option>
<option value="NE"> Niger </option>
<option value="NG"> Nigeria </option>
<option value="NU"> Niue </option>
<option value="NF"> Norfolk Island </option>
<option value="MP"> Northern Mariana Islands </option>
<option value="NO"> Norway </option>
<option value="OM"> Oman </option>
<option value="PK"> Pakistan </option>
<option value="PW"> Palau </option>
<option value="PS"> Palestinian Territory, Occupied </option>
<option value="PA"> Panama </option>
<option value="PG"> Papua New Guinea </option>
<option value="PY"> Paraguay </option>
<option value="PE"> Peru </option>
<option value="PH"> Philippines </option>
<option value="PN"> Pitcairn </option>
<option value="PL"> Poland </option>
<option value="PT"> Portugal </option>
<option value="PR"> Puerto Rico </option>
<option value="QA"> Qatar </option>
<option value="RE"> Reunion </option>
<option value="RO"> Romania </option>
<option value="RU"> Russian Federation </option>
<option value="RW"> Rwanda </option>
<option value="GS"> S. Georgia and S. Sandwich Isls. </option>
<option value="KN"> Saint Kitts and Nevis </option>
<option value="LC"> Saint Lucia </option>
<option value="VC"> Saint Vincent & the Grenadines </option>
<option value="WS"> Samoa </option>
<option value="SM"> San Marino </option>
<option value="ST"> Sao Tome and Principe </option>
<option value="SA"> Saudi Arabia </option>
<option value="SN"> Senegal </option>
<option value="RS"> Serbia </option>
<option value="SC"> Seychelles </option>
<option value="SL"> Sierra Leone </option>
<option value="SG"> Singapore </option>
<option value="SI"> Slovenia </option>
<option value="SK"> Slovak Republic </option>
<option value="SB"> Solomon Islands </option>
<option value="SO"> Somalia </option>
<option value="ZA"> South Africa </option>
<option value="GS"> S. Georgia and S. Sandwich Isls. </option>
<option value="ES"> Spain </option>
<option value="LK"> Sri Lanka </option>
<option value="SH"> St. Helena </option>
<option value="PM"> St. Pierre and Miquelon </option>
<option value="SD"> Sudan </option>
<option value="SR"> Suriname </option>
<option value="SJ"> Svalbard & Jan Mayen Islands </option>
<option value="SZ"> Swaziland </option>
<option value="SE"> Sweden </option>
<option value="CH"> Switzerland </option>
<option value="SY"> Syria </option>
<option value="TW"> Taiwan </option>
<option value="TJ"> Tajikistan </option>
<option value="TZ"> Tanzania </option>
<option value="TH"> Thailand </option>
<option value="TG"> Togo </option>
<option value="TK"> Tokelau </option>
<option value="TO"> Tonga </option>
<option value="TT"> Trinidad and Tobago </option>
<option value="TN"> Tunisia </option>
<option value="TR"> Turkey </option>
<option value="TM"> Turkmenistan </option>
<option value="TC"> Turks and Caicos Islands </option>
<option value="TV"> Tuvalu </option>
<option value="UG"> Uganda </option>
<option value="UA"> Ukraine </option>
<option value="AE"> United Arab Emirates </option>
<option value="GB"> United Kingdom </option>
<option  value="US"> United States </option>
<option value="UM"> US Minor Outlying Islands </option>
<option value="UY"> Uruguay </option>
<option value="SU"> USSR (former) </option>
<option value="UZ"> Uzbekistan </option>
<option value="VU"> Vanuatu </option>
<option value="VA"> Vatican City State (Holy See) </option>
<option value="VE"> Venezuela </option>
<option value="VN"> Viet Nam </option>
<option value="VG"> British Virgin Islands </option>
<option value="VI"> Virgin Islands (U.S.) </option>
<option value="WF"> Wallis and Futuna Islands </option>
<option value="EH"> Western Sahara </option>
<option value="YE"> Yemen </option>
<option value="YU"> Yugoslavia (former) </option>
<option value="ZM"> Zambia </option>
<option value="ZW"> Zimbabwe  </option>
</select>
    </td>
  </tr>

  <tr>
    <td>
      <strong><span id="required">*</span>
        State : 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="state" style="width:225px;" value="Karnataka"/>
    </td>
  </tr>

  <tr>
    <td>
      <strong><span id="required">*</span>
        Locality : 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="locality" style="width:225px;" value="Bangalore"/>
    </td>
  </tr>

  <tr>
    <td>
      <strong>
        SAN's (optional) : 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="san" style="width:225px;" placeholder="abc.net, xyz.com"/>
    </td>
  </tr>

  <tr>
    <td>
      <strong>
        Email (optional): 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="email" style="width:225px;" placeholder="abc@xyz.com"/>
    </td>
  </tr>

  <tr>
    <td>
      <strong>
        Ip's (optional): 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="ip" style="width:225px;" placeholder="10.12.21.16, 10.21.11.56"/>
    </td>
  </tr>

  <tr>
    <td>
      <strong>
        Uri's (optional): 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="uri" style="width:225px;" placeholder="www.abc.com, xty.com"/>
      <br>
    </td>
  </tr>
  
   <tr >
  <td>
    
  </td>
    <td >
      <center>
        <button type="button" class="btn btn-primary" id="submit" >Submit</button>
      </center>
    </td>
  </tr>
</tbody>
</table>
</form>
</div>

<div class="col-lg-8">
  <br>
  <br>
  <br>
  <table >
    <tbody>
      <tr>
        <td>
          <kbd>
            CSR :
          </kbd>
        </td>
      </tr>
      <tr>
        <td>
          <textarea style="font-size: 15px" class="form-control"  id="csr"   cols="90" rows="13" readonly="readonly"></textarea>
          </br>
          </td>
          
          <td  align="center">
           <a   id="csrDownload"  class="btn btn-link" data-toggle="tooltip" data-placement="right" title="Download CSR"  disabled>        
          <img height="40px" width="40px" src="./Icon/download.png">
        </a>
          </td>
        </tr>
      <tr>
        <td>
          <kbd>
            Private Key :
          </kbd>
          
        </td>
      </tr>
      <tr>
        <td>
          <textarea style="font-size: 15px" class="form-control"  id="privateKey"  cols="90" rows="13" readonly="readonly"></textarea>
        </td>
        <td  align="center">
           <a   id="privateKeyDownload" class="btn btn-link" data-toggle="tooltip" data-placement="right" title="Download Private Key" disabled>        
          <img height="40px" width="40px" src="./Icon/download.png">
        </a>
          </td>
      </tr>
    </tbody>
  </table>
</div>
<!-- Row class div -->
</div>
<script type="text/javascript">
$("input[placeholder]").each(function () {
    $(this).attr("data-placeholder", this.placeholder);

    $(this).bind("focus", function () {
        this.placeholder = '';
    });
    $(this).bind("blur", function () {
        this.placeholder = $(this).attr("data-placeholder");
    });
});
</script>

<script type="text/javascript">

// Ajax Call



$("#submit").click(function(){
	  $("#csr").val('');
	  $("#privateKey").val('');
			  $("#submit").prop("disabled", true);
  var postData= {
  'commonName': $("#cn").val(),
  'organization': $("#org").val(),
  'organizationUnit': $("#orgUnit").val(),
  'locality': $("#locality").val(),
  'state': $("#state").val(),
  'country': $("#country").val(),
  'keyAlgorithm': $("#keyAlgo").val(),
  'signatureAlgorithm': $("#sigAlgo").val(),
  'keySize': $("#keySize").val(),
  'csrEmail': $("#email").val(),
  'csrSan': $("#san").val(),
  'csrIps': $("#ip").val(),
  'csrUri': $("#uri").val()
}
console.log("CSR  Post:");
console.log(postData);

$.ajax({
	method: "POST",
  url: "/genCsr",
  contentType:"application/json",
  dataType:"json",
  data: JSON.stringify(postData),
    success:function( data ) {
  	  $("#csr").val(data.csr);
  	  $("#privateKey").val(data.privateKey);
  	  $("#submit").prop("disabled", false);
  	if(data.csr.startsWith("-----BEGIN CERTIFICATE REQUEST-----")){
  		$("#csrDownload").prop("disabled", false);
  		$("#privateKeyDownload").prop("disabled", false);
  	  $("#csrDownload").attr("href","/downloadCsr?csr="+data.csr);
  	$("#privateKeyDownload").attr("href","/downloadPrivateKey?privateKey="+data.privateKey);
  	  }
    }
})
});


</script>


</body>
</html>
