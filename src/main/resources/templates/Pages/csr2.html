<html>
<head>
<title>
CSR
</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">

<!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js" crossorigin="anonymous"></script> -->

<link href="css/csr.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

<!-- <script src="js/jquery.easydropdown.js" type="text/javascript"></script> -->
<!--  -->

</head>
<body>
 


<div class="row">
<div class="col-lg-4" style="margin: 0px; padding: 0px">
<div id="mySidenav" class="sidenav">
  <a href="/keySpecs" id="keyz" target="blank">KeySize</a>
  <a href="https://cryptoreport.websecurity.symantec.com/checker/views/csrCheck.jsp" target="blank" id="decoder">Decoder </a>
</div>
<form>
<table align="center">
<tbody >
<br>
<br>
<br>
  <tr>
    <td>
      <strong>
       Key Algorithm : 
      </strong>
    </td>
    <td>
      <select class="form-control" id="keyAlgo" name="KeyAlgorithm" style="width:225px;">
        <option value="RSA" selected='selected'>RSA</option>
        <option value="DSA">DSA</option>
        <option value="ECC">ECC</option>
      </select>
    </td>
  </tr>
  <tr>
    <td>
      <strong>
        Signature Algorithm : 
      </strong>
    </td>
    <td>
       <select class="form-control" id="sigAlgo" name="SignatureAlgorithm" style="width:225px;">
       </select>
    </td>
    <!-- For Select drop down -->
     <!-- For Select drop down -->
      <script type="text/javascript">
          (function() {
                    var bOptions = {
                      "RSA": ["SHA256", "SHA1", "SHA512", "MD5"],
                      "DSA": ["SHA256", "SHA1"],
                      "ECC": ["SHA256", "SHA1", "SHA384", "SHA512"]
                    };

                    var keyAlgoVar = document.getElementById('keyAlgo');
                    var sigAlgoVar = document.getElementById('sigAlgo');

                    //on change is a good event for this because you are guarenteed the value is different
                    keyAlgoVar.onchange = function() {
                      //clear out B
                      sigAlgoVar.length = 0;
                      //get the selected value from A
                      var _val = this.options[this.selectedIndex].value;
                      //loop through bOption at the selected value
                      for (var i in bOptions[_val]) {
                        //create option tag
                        var op = document.createElement('option');
                        //set its value
                        op.value = bOptions[_val][i];
                        //set the display label
                        op.text = bOptions[_val][i];
                        //append it to B
                        sigAlgoVar.appendChild(op);
                      }
                    };
                    //fire this to update B on load
                    keyAlgoVar.onchange();

                  })();
      </script>
  </tr>

  <tr>
    <td>
      <strong><span id="required">*</span>
        Key Size :
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="keySize" style="width:225px;" placeholder="2048"  required="required"/>

   </td>

  </tr>

  <tr>
    <td>
      <strong>
        Common Name : 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="cn" style="width:225px;" placeholder="abc.bbtest.net"/>
    </td>
  </tr>


  <tr>
    <td>
      <strong>
        Organization : 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="org" style="width:225px;" placeholder="Org"/>
    </td>
  </tr>

  <tr>
    <td>
      <strong>
        Organizational Unit : 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="orgUnit" style="width:225px;" placeholder="OrgUnit"/>
    </td>
  </tr>

  <tr>
    <td>
      <strong><span id="required">*</span>
        Country : 
      </strong>
    </td>
    <td>
      <input class="form-control" maxlength="2"  type="text" id="country" style="width:225px;" placeholder="IN" required="required"/>
    </td>
  </tr>

  <tr>
    <td>
      <strong>
        State : 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="state" style="width:225px;" placeholder="Karnataka"/>
    </td>
  </tr>

  <tr>
    <td>
      <strong>
        Locality : 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="locality" style="width:225px;" placeholder="Banglore"/>
    </td>
  </tr>

  <tr>
    <td>
      <strong>
        SAN's (optional) : 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="san" style="width:225px;" placeholder="abc.net, xyz.com"/>
    </td>
  </tr>

  <tr>
    <td>
      <strong>
        Email (optional): 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="email" style="width:225px;" placeholder="abc@xyz.com"/>
    </td>
  </tr>

  <tr>
    <td>
      <strong>
        Ip's (optional): 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="ip" style="width:225px;" placeholder="10.12.21.16, 10.21.11.56"/>
    </td>
  </tr>

  <tr>
    <td>
      <strong>
        Uri's (optional): 
      </strong>
    </td>
    <td>
      <input class="form-control" type="text" id="uri" style="width:225px;" placeholder="www.abc.com, xty.com"/>
      <br>
    </td>
  </tr>
  
   <tr >
  <td>
    
  </td>
    <td >
      <center>
        <button type="button" class="btn btn-primary" id="submit" >Submit</button>
      </center>
    </td>
  </tr>
</tbody>
</table>
</form>
</div>

<div class="col-lg-8">
  <br>
  <br>
  <br>
  <table >
    <tbody>
      <tr>
        <td>
          <kbd>
            CSR :
          </kbd>
        </td>
      </tr>
      <tr>
        <td>
          <textarea style="font-size: 15px" class="form-control"  id="csr"   cols="90" rows="13" readonly="readonly"></textarea>
          </br>
          <!-- readonly="readonly" -->
        </tr>
      <tr>
        <td>
          <kbd>
            Private Key :
          </kbd>
          
        </td>
      </tr>
      <tr>
        <td>
          <textarea style="font-size: 15px" class="form-control"  id="privateKey"  cols="90" rows="13" readonly="readonly"></textarea>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<!-- Row class div -->
</div>
<script type="text/javascript">
$("input[placeholder]").each(function () {
    $(this).attr("data-placeholder", this.placeholder);

    $(this).bind("focus", function () {
        this.placeholder = '';
    });
    $(this).bind("blur", function () {
        this.placeholder = $(this).attr("data-placeholder");
    });
});
</script>

<script type="text/javascript">

// Ajax Call



$("#submit").click(function(){
	   var keySize = $("#keySize").val();
	  var country = $("#country").val();
	  if(keySize == ''){
		  window.alert("Key Size cannot be blank");
	  }else if(country == ''){
		  window.alert("Country cannot be blank");
	  }
	  
	  else{ 
	  $("#csr").val('');
	  $("#privateKey").val('');
			  $("#submit").prop("disabled", true);
  var postData= {
  'commonName': $("#cn").val(),
  'organization': $("#org").val(),
  'organizationUnit': $("#orgUnit").val(),
  'locality': $("#locality").val(),
  'state': $("#state").val(),
  'country': $("#country").val(),
  'keyAlgorithm': $("#keyAlgo").val(),
  'signatureAlgorithm': $("#sigAlgo").val(),
  'keySize': $("#keySize").val(),
  'csrEmail': $("#email").val(),
  'csrSan': $("#san").val(),
  'csrIps': $("#ip").val(),
  'csrUri': $("#uri").val()
}
console.log("CSR  Post:");
console.log(postData);

$.ajax({
	method: "POST",
  url: "/genCsr",
  contentType:"application/json",
  dataType:"json",
  data: JSON.stringify(postData),
    success:function( data ) {
  	  $("#csr").val(data.csr);
  	  $("#privateKey").val(data.privateKey);
  	  $("#submit").prop("disabled", false);
    }
})

 } 
});


</script>


</body>
</html>
